<div class="flex flex-col py-6">
    <div class="flex items-center gap-2">
      <h2 class="text-lg">Participants</h2>
    </div>
    <p-divider />
  </div>
  <p-table 
    [tableStyle]="{ 'min-width': '50rem' }"
    [globalFilterFields]="['type', 'personsNames', 'id']" [paginator]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    [rowHover]="true" [rows]="10" [showCurrentPageReport]="true" [rowsPerPageOptions]="[10, 25, 50]" styleClass="p-datatable-gridlines" #dt
    [value]="participantsList()">
    <ng-template pTemplate="caption">
      <div class="flex justify-between">
        <div class="flex gap-2">
            <p-button [disabled]="participantsList().length === 0" (onClick)="onPrint()" icon="pi pi-print" outlined pTooltip="Imprimer"/>
            <p-button (onClick)="onAddParticipant()" label="Ajouter" icon="pi pi-plus" />
        </div>
        <p-iconField iconPosition="left">
          <p-inputIcon><i class="pi pi-search"></i></p-inputIcon>
          <input #search pInputText type="text" (input)="dt.filterGlobal(search.value, 'contains')" placeholder="Rechercher un participant" />
        </p-iconField>
      </div>
    </ng-template>
    <ng-template pTemplate="header">
        <tr>
            <th>Nom</th>
            <th>Pr√©nom</th>
            <th>Genre</th>
            <th>Age</th>
            <th>Poids</th>
            <th>Club</th>
            @if(this.competition()?.type === 'tao-lu') {
              <th class="w-[30rem]">Rubrique</th>
            }
            <th>Actions</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-participant>
        <tr>
            <td>{{ participant.lastname }}</td>
            <td>{{ participant.firstname }}</td>
            <td>{{ participant.gender }}</td>
            <td>{{ participant.age }} ans</td>
            <td>{{ participant.weight }} kg</td>
            <td>{{ participant.clubName }}</td>
            @if(this.competition()?.type === 'tao-lu') {
              <td>
                <div class="flex gap-2">
                  @for (discipline of participant.disciplines.slice(0, participant.disciplines.length > 4 ? 3 : participant.disciplines.length); track discipline) {
                    <p-chip class="text-[0.8rem]" size="small" [label]="discipline.name"></p-chip>
                  }
                  @if (participant.disciplines.length > 4) {
                    <span class="text-[0.8rem] text-gray-500 self-center">...</span>
                  }
                </div>
              </td>
            }
            <td class="">
              <div class="flex gap-2">
                <p-button (onClick)="onEdit(participant)" icon="pi pi-pencil" severity="secondary" [outlined]="true" />
                <p-button (onClick)="onDelete(participant)" icon="pi pi-trash" severity="danger" [outlined]="true" />
              </div>
            </td>
        </tr>
    </ng-template>
  </p-table>
  
  <p-confirmdialog />